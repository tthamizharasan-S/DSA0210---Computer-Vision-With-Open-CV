import cv2
import os
from matplotlib import pyplot as plt

cascade_filename = "haarcascade_frontalface_default.xml"


if not os.path.exists(cascade_filename):
    print(f"Downloading {cascade_filename}...")
    !wget https://raw.githubusercontent.com/opencv/opencv/master/data/haarcascades/{cascade_filename}

face = cv2.CascadeClassifier(cascade_filename)


if face.empty():
    print(f"Error: Could not load cascade classifier '{cascade_filename}'. Please ensure the file is present and valid.")
else:
    image_filename = "/content/FACE DETECTION.jpeg"
    img = cv2.imread(image_filename)


    if img is None:
        print(f"Error: Could not load image '{image_filename}'. Please ensure the file is present in /content/ and the path is correct.")
        print("You might need to upload 'FACE DETECTION.jpeg' to your Colab environment or use a different image path.")
    else:
        gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)

        faces = face.detectMultiScale(gray, 1.3, 5)

        for (x,y,w,h) in faces:
            cv2.rectangle(img, (x,y), (x+w, y+h), (0,255,0), 2)

        plt.imshow(cv2.cvtColor(img, cv2.COLOR_BGR2RGB)) 
        plt.title("Face Detection Result")
        plt.axis('off') 
        plt.show()
